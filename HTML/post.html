<!DOCTYPE html>
<html>
<head>
<style>
form * {
  display: block;
  margin: 10px;
}
</style>

<body>

  <form id="postForm" method="post" enctype="multipart/form-data">
    <div class="form-group">
      <textarea class="form-control-text" 
                id="text" 
                name="text" 
                rows="8" cols="50"> </textarea>
      <input type="file" 
            class="form-control-file" 
            id="img" 
            label="Upload image:" 
            name="img_upload" 
            accept=".jpg, .jpeg, .png" />
      <input type="submit" value="Post">
    </div>
  </form>

</body>

<script>  
  const form = document.getElementById("postForm");
  //upload listener
  form.addEventListener("submit",async (e) => {
    e.preventDefault();

    const formData = new FormData(form);
  
    try{
      const response = await fetch("http://127.0.0.1:3000/", {
        method: "POST",
        //headers: { "Content-Type": "application/json" },
        body: formData
      });
      console.log("post request attempted...");


      if (!response.ok) {
        throw new Error(`Response status: ${response.status}`);
        }
      
      console.log("here is the response: "+ response);
      const result = await response.json();
      console.log(result);
    }

    catch (error) {
      console.error(error.message);
    }

  });
</script>

</head>
</html>