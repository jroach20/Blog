<!DOCTYPE html>
<html>
<head>
<style>
form * {
  display: block;
  margin: 10px;
}
</style>

<body>
  <form id="postForm" method="post">
    <textarea name="text" rows="3" cols="50"></textarea>
    <input type="submit" value="Post">
  </form>

  <form id="imgForm" action="/upload-endpoint" enctype="multipart/form-data" method="post">
    <label for="img_upload">Upload image:</label>
    <input type="file" name="img_upload" accept=".jpg, .jpeg, .png" />
  </form>

</body>

<script>

  //image upload listener
  document.querySelector("input[name='img_upload']").addEventListener("change", (e) => {
    const file = e.target.files[0];
    console.log("File selected:");
    console.log(file);
  });
  
  //text upload listener
  document.getElementById("postForm").addEventListener("submit",async (e) => {
    e.preventDefault();
    const text = e.target.text.value;

    try{
      const response = await fetch("http://127.0.0.1:3000/", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ text })
      });


      if (!response.ok) {
        throw new Error(`Response status: ${response.status}`);
        }
      
      console.log("here is the response: "+ response);
      const result = await response.json();
      console.log(result);
    }

    catch (error) {
      console.error(error.message);
    }

  });
</script>

</head>
</html>